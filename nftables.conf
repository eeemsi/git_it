#!/usr/sbin/nft -f

flush ruleset

table inet filter {
	chain input {
		type filter hook input priority 0; policy drop;

		# accept any localhost traffic
		iif "lo" accept

		# accept traffic originated from us
		ct state established,related accept

		# accept neighbour discovery otherwise IPv6 connectivity breaks
		icmpv6 type { nd-router-advert, nd-neighbor-solicit, nd-neighbor-advert } accept

		# log all dropped oackages
		#log prefix "DROPPED:" flags all drop
	}

	chain forward {
		type filter hook forward priority 0; policy drop;
	}

	chain output {
		type filter hook output priority 0; policy accept;
	}
}
