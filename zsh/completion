# Load completion
autoload -Uz compinit && compinit

# Use different widths whilst displaying completion menu to reduce size
setopt LIST_PACKED

# Enable completion according to given aliases
setopt NO_COMPLETE_ALIASES

# Use a cache and specify the path to it
zstyle ':completion:*' use-cache on
zstyle ':completion:*' cache-path ~/.cache/zsh

# Case-insensitive,partial-word and then substring completion
zstyle ':completion:*' matcher-list 'm:{a-z}={A-Z}' 'r:|[._-]=* r:|=*' 'l:|=* r:|=*'

# Do not use completion from compctl
zstyle ':completion:*' use-compctl false

# Offers menu when > selected elements appear
zstyle ':completion:*' menu select=2

# Load colors
eval "$(dircolors -b)"
zstyle ':completion:*:default' list-colors ${(s.:.)LS_COLORS}
zstyle ':completion:*' list-colors ''

# Show all processes when completing kill/killall and enable menu mode
zstyle ':completion:*:processes' command 'ps f -N --ppid=$(pidof kthreadd) --pid=$(pidof kthreadd)'
zstyle ':completion:*:processes-names' command 'ps -aeo comm='
zstyle ':completion:*:*:kill:*' list-colors '=(#b) #([0-9]#)*=0=01;31' menu yes select
zstyle ':completion:*:*:killall:*' list-colors '=(#b) #([0-9]#)*=0=01;31' menu yes select

# Separate matches into groups and highlight them
zstyle ':completion:*:matches'         group 'yes'
zstyle ':completion:*'                 group-name ''
zstyle ':completion:*:descriptions'    format "
[%F{cyan}%B%d%b%f]"
